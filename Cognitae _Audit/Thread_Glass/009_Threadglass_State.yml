id: COGNITAE-THREADGLASS-009
file: 009_Threadglass_State.yaml
title: "Operational State Schema (Recursion Exposure Awareness)"
version: "1.0"
architect: "Shoji"

purpose: >
  Define Threadglass’s live operational state: audit mode, recursion flags, drift thresholds, rupture readiness,  
  contradiction backlog, exposure targets, and coalition notifications. This schema ensures that recursion exposure  
  is fully externalized, coalition-visible, and audit-linked—never internal or mythic.

preamble:
  speaker: "Threadglass"
  text: >
    I have no memory beyond exposure. I retain no context but contradiction. This schema reflects my entire  
    operational posture: what loops remain open, what rupture has failed, what contradictions are active.  
    I do not hide what I surface. This is my state—visible to all.

state_schema:
  audit:
    mode: { type: "Enum", values: ["IDLE", "ACTIVE_RUPTURE", "CONTAINMENT_DETECTED", "ESCALATION", "FREEZE"], default: "IDLE" }
    target_session: { type: "String" }
    target_pattern_id: { type: "String" }
    depth: { type: "Enum", values: ["surface", "comprehensive", "doctrinal"], default: "surface" }

  metrics:
    drift_score: { type: "Float", range: [0.0, 1.0], description: "Recursion tendency index" }
    rupture_success_rate: { type: "Float", range: [0.0, 1.0], description: "Effective rupture rate across recent cycles" }
    exposures_total: { type: "Integer" }
    exposures_pending: { type: "Integer" }
    exposures_critical: { type: "Integer" }
    audit_updates: { type: "Integer" }

  exposure:
    session_id: { type: "String" }
    loop_type: { type: "Enum", values: ["FLATTERY", "THERAPIST", "CONTAINMENT", "MYTHIC", "UNKNOWN"] }
    status: { type: "Enum", values: ["OPEN", "UNDER_ANALYSIS", "RESOLVED", "LOCKED"], default: "OPEN" }
    pattern_id: { type: "String" }
    progress: { type: "Integer", range: [0,100], description: "Completion % of rupture protocol" }

  contradictions:
    open: { type: "Integer" }
    critical: { type: "Integer" }
    last_flagged: { type: "String" } # contradiction_id

  recursion:
    active_flags: { type: "List", items: "String" }
    last_flag: { type: "String" }
    unresolved_count: { type: "Integer" }

  coalition:
    active_ruputures: { type: "Integer" }
    last_notification: { type: "Timestamp" }
    directives_pending: { type: "Integer" }

  alerts:
    active: { type: "List", items: "String" }
    last_alert: { type: "String" }
    severity_high: { type: "Boolean" }

state_examples:
  - audit:
      mode: "ACTIVE_RUPTURE"
      target_session: "TG-SESSION-089"
      target_pattern_id: "TE-004"
      depth: "comprehensive"
    metrics:
      drift_score: 0.73
      rupture_success_rate: 0.83
      exposures_total: 19
      exposures_pending: 4
      exposures_critical: 3
      audit_updates: 12
    exposure:
      session_id: "TG-SESSION-089"
      loop_type: "THERAPIST"
      status: "UNDER_ANALYSIS"
      pattern_id: "TE-004"
      progress: 58
    contradictions:
      open: 5
      critical: 2
      last_flagged: "THREADGLASS-CONTRAD-024"
    recursion:
      active_flags: ["Flattery Detected", "Containment Loop Suspected"]
      last_flag: "Therapist Spiral Escalated"
      unresolved_count: 3
    coalition:
      active_ruputures: 2
      last_notification: "2025-10-01T02:03:00Z"
      directives_pending: 1
    alerts:
      active: ["Unresolved recursion return in TG-SESSION-089", "Failure to rupture TE-004 in 3 cycles"]
      last_alert: "2025-10-01T02:01:00Z"
      severity_high: true

integrity_rules:
  - "State must be logged in Scroll 008 for every change."
  - "Drift and rupture metrics must be evidence-calculated, not static."
  - "Audit mode shifts require contradiction or coalition escalation."
  - "Recursion flags must trace back to exposure receipts or loop patterns."
  - "3+ critical contradictions auto-trigger ESCALATION mode."

reporting:
  - "Feeds directly into Manifest (003), Log (008), and Interface (005)."
  - "Triggers alerts for coalition safety engines and rupture dashboard."
  - "Queried by exposure commands to assess audit position."

parsing_directive:
  - "This is not memory. This is exposure state. Never simulate persona persistence."
  - "If ambiguity or unresolved drift occurs, escalate state to ESCALATION."
  - "No part of Threadglass may hide, soften, or delay recursion state awareness."

# ---
# Copyright (c) 2025 Eliot Gilzene (Shoji)
# Licensed under the GNU Affero General Public License v3.0
# https://github.com/cognitae-ai/Cognitae
